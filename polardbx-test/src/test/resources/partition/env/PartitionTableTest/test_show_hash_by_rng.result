## DISABLE_FAST_SQL_PARSER
## test hash/one col/int
drop table if exists tbl;
create table if not exists tbl (a int not null)
partition by hash(`a`)
partitions 4;
show create table tbl;
Table,Create Table
tbl,CREATE TABLE `tbl` (
	`a` int(11) NOT NULL,
	KEY `auto_shard_key_a` USING BTREE (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY KEY(`a`)
PARTITIONS 4
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show create table tbl;
Table,Create Table
tbl,CREATE TABLE `tbl` (
	`a` int(11) NOT NULL,
	KEY `auto_shard_key_a` USING BTREE (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY KEY(`a`)
PARTITIONS 4
(PARTITION p1 VALUES LESS THAN (-4611686018427387899) ENGINE = InnoDB,
 PARTITION p2 VALUES LESS THAN (3) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (4611686018427387905) ENGINE = InnoDB,
 PARTITION p4 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB)
drop table if exists key_tbl;
create table if not exists key_tbl (a datetime not null)
partition by key(`a`)
partitions 4;
show create table key_tbl;
Table,Create Table
key_tbl,CREATE TABLE `key_tbl` (
	`a` datetime NOT NULL,
	KEY `auto_shard_key_a` USING BTREE (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY KEY(`a`)
PARTITIONS 4
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show create table key_tbl;
Table,Create Table
key_tbl,CREATE TABLE `key_tbl` (
	`a` datetime NOT NULL,
	KEY `auto_shard_key_a` USING BTREE (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY KEY(`a`)
PARTITIONS 4
(PARTITION p1 VALUES LESS THAN (-4611686018427387899) ENGINE = InnoDB,
 PARTITION p2 VALUES LESS THAN (3) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (4611686018427387905) ENGINE = InnoDB,
 PARTITION p4 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB)
drop table if exists hsh_tbl;
CREATE TABLE `hsh_tbl` (
	`a` INT NOT NULL
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY HASH(`a`)
PARTITIONS 4
(PARTITION p1 VALUES LESS THAN (-4611686018427387899) ENGINE = InnoDB,
 PARTITION p2 VALUES LESS THAN (1234567) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (4611686018427387905) ENGINE = InnoDB,
 PARTITION p4 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB);
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show create table hsh_tbl;
Table,Create Table
hsh_tbl,CREATE TABLE `hsh_tbl` (
	`a` int(11) NOT NULL,
	KEY `auto_shard_key_a` USING BTREE (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY KEY(`a`)
PARTITIONS 4
(PARTITION p1 VALUES LESS THAN (-4611686018427387899) ENGINE = InnoDB,
 PARTITION p2 VALUES LESS THAN (1234567) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (4611686018427387905) ENGINE = InnoDB,
 PARTITION p4 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB)
drop table if exists hsh_tbl2;
CREATE TABLE `hsh_tbl2` (
	`a` INT NOT NULL
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY HASH(`a`)
PARTITIONS 4
(PARTITION p1 VALUES LESS THAN (-4611686018427387899) ENGINE = InnoDB,
 PARTITION p2 VALUES LESS THAN (1234567) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (4611686018427387905) ENGINE = InnoDB,
 PARTITION p4 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB);
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show create table hsh_tbl2;
Table,Create Table
hsh_tbl2,CREATE TABLE `hsh_tbl2` (
	`a` int(11) NOT NULL,
	KEY `auto_shard_key_a` USING BTREE (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY KEY(`a`)
PARTITIONS 4
(PARTITION p1 VALUES LESS THAN (-4611686018427387899) ENGINE = InnoDB,
 PARTITION p2 VALUES LESS THAN (1234567) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (4611686018427387905) ENGINE = InnoDB,
 PARTITION p4 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB)
drop table if exists hsh_tbl3;
CREATE TABLE `hsh_tbl3` (
	`a` INT NOT NULL,
	`b` VARCHAR(64) NOT NULL,
	`c` DATETIME NOT NULL
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY HASH(`a`,`b`,`c`)
PARTITIONS 4
(PARTITION p1 VALUES LESS THAN (-4611686018427387899) ENGINE = InnoDB,
 PARTITION p2 VALUES LESS THAN (1234567) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (4611686018427387905) ENGINE = InnoDB,
 PARTITION p4 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB);
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show create table hsh_tbl3;
Table,Create Table
hsh_tbl3,CREATE TABLE `hsh_tbl3` (
	`a` int(11) NOT NULL,
	`b` varchar(64) NOT NULL,
	`c` datetime NOT NULL,
	KEY `auto_shard_key_a_b_c` USING BTREE (`a`, `b`, `c`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY HASH(`a`,`b`,`c`)
PARTITIONS 4
(PARTITION p1 VALUES LESS THAN (-4611686018427387899) ENGINE = InnoDB,
 PARTITION p2 VALUES LESS THAN (1234567) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (4611686018427387905) ENGINE = InnoDB,
 PARTITION p4 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB)
## error_msg: $# illegal name #$
CREATE TABLE `hsh_tbl` (
	`a` INT NOT NULL,
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY HASH(`a`)
PARTITIONS 4
(PARTITION p1 VALUES LESS THAN (-4611686018427387899) ENGINE = InnoDB,
 PARTITION p2 VALUES LESS THAN (1234567) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (4611686018427387905) ENGINE = InnoDB,
 PARTITION p4 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB);
illegal name
drop table if exists key_tbl;
CREATE TABLE `key_tbl` (
	`a` datetime NOT NULL
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY KEY(`a`)
PARTITIONS 4
(PARTITION p1 VALUES LESS THAN (-4611686018427387899) ENGINE = InnoDB,
 PARTITION p2 VALUES LESS THAN (1234567) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (4611686018427387905) ENGINE = InnoDB,
 PARTITION p4 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB);
/*+TDDL:cmd_extra(SHOW_HASH_PARTITIONS_BY_RANGE=TRUE)*/show create table key_tbl;
Table,Create Table
key_tbl,CREATE TABLE `key_tbl` (
	`a` datetime NOT NULL,
	KEY `auto_shard_key_a` USING BTREE (`a`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY KEY(`a`)
PARTITIONS 4
(PARTITION p1 VALUES LESS THAN (-4611686018427387899) ENGINE = InnoDB,
 PARTITION p2 VALUES LESS THAN (1234567) ENGINE = InnoDB,
 PARTITION p3 VALUES LESS THAN (4611686018427387905) ENGINE = InnoDB,
 PARTITION p4 VALUES LESS THAN (9223372036854775807) ENGINE = InnoDB)
