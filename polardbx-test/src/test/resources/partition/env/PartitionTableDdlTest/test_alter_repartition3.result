DROP TABLE IF EXISTS tbl;
CREATE TABLE IF NOT EXISTS tbl (
	a int NOT NULL,
	b int NOT NULL,
	c int NOT NULL,
	d int NOT NULL,
	PRIMARY KEY (`a`)
)
PARTITION BY KEY (a);
INSERT INTO tbl
VALUES (101, 101, 101, 101),
	(102, 102, 102, 102),
	(103, 103, 103, 103),
	(201, 201, 201, 201),
	(202, 202, 202, 202),
	(203, 203, 203, 203);
SELECT *
FROM tbl
ORDER BY a;
a,b,c,d
101,101,101,101
102,102,102,102
103,103,103,103
201,201,201,201
202,202,202,202
203,203,203,203
ALTER TABLE tbl
PARTITION BY KEY (a, b);
SHOW CREATE TABLE tbl;
Table,Create Table
tbl,CREATE TABLE `tbl` (
	`a` int(11) NOT NULL,
	`b` int(11) NOT NULL,
	`c` int(11) NOT NULL,
	`d` int(11) NOT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_a_b` USING BTREE (`a`, `b`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY KEY(`a`,`b`)
PARTITIONS 3
SELECT *
FROM tbl
ORDER BY a;
a,b,c,d
101,101,101,101
102,102,102,102
103,103,103,103
201,201,201,201
202,202,202,202
203,203,203,203
ALTER TABLE tbl
PARTITION BY KEY (a, c);
SHOW CREATE TABLE tbl;
Table,Create Table
tbl,CREATE TABLE `tbl` (
	`a` int(11) NOT NULL,
	`b` int(11) NOT NULL,
	`c` int(11) NOT NULL,
	`d` int(11) NOT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_a_c` USING BTREE (`a`, `c`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY KEY(`a`,`c`)
PARTITIONS 3
SELECT *
FROM tbl
ORDER BY a;
a,b,c,d
101,101,101,101
102,102,102,102
103,103,103,103
201,201,201,201
202,202,202,202
203,203,203,203
ALTER TABLE tbl
PARTITION BY KEY (a, b, c);
SHOW CREATE TABLE tbl;
Table,Create Table
tbl,CREATE TABLE `tbl` (
	`a` int(11) NOT NULL,
	`b` int(11) NOT NULL,
	`c` int(11) NOT NULL,
	`d` int(11) NOT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_a_b_c` USING BTREE (`a`, `b`, `c`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY KEY(`a`,`b`,`c`)
PARTITIONS 3
SELECT *
FROM tbl
ORDER BY a;
a,b,c,d
101,101,101,101
102,102,102,102
103,103,103,103
201,201,201,201
202,202,202,202
203,203,203,203
ALTER TABLE tbl
PARTITION BY KEY (d);
SHOW CREATE TABLE tbl;
Table,Create Table
tbl,CREATE TABLE `tbl` (
	`a` int(11) NOT NULL,
	`b` int(11) NOT NULL,
	`c` int(11) NOT NULL,
	`d` int(11) NOT NULL,
	PRIMARY KEY (`a`),
	KEY `auto_shard_key_d` USING BTREE (`d`)
) ENGINE = InnoDB DEFAULT CHARSET = utf8mb4
PARTITION BY KEY(`d`)
PARTITIONS 3
SELECT *
FROM tbl
ORDER BY a;
a,b,c,d
101,101,101,101
102,102,102,102
103,103,103,103
201,201,201,201
202,202,202,202
203,203,203,203